<script>
const PRODUCTS_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQA2pIOTPv2AVnMSWtlKLJeSXQXxTllgHn2gGYcdd_ZbHARLmclz_OXy009Aw9hJqgpc-RXIk_HXkK4/pub?gid=0&single=true&output=csv";

// Convert CSV → array of objects
function csvToArray(csv) {
    const lines = csv.split("\n");
    const headers = lines[0].split(",");

    return lines.slice(1).map(line => {
        const values = line.split(",");
        let obj = {};
        headers.forEach((h, i) => obj[h.trim()] = values[i] ? values[i].trim() : "");
        return obj;
    });
}

// Load products and display on screen
async function loadProducts() {
    try {
        const res = await fetch(PRODUCTS_CSV_URL);
        const csv = await res.text();

        const products = csvToArray(csv);

        const container = document.getElementById("product-list");
        container.innerHTML = "";

        products.forEach(p => {
            if (!p.ProductName) return;  // skip blank rows

            const card = `
                <div class="product-card">
                    <img src="${p.ImageURL || 'default.jpg'}">
                    <h3>${p.ProductName}</h3>
                    <p class="category">${p.Category}</p>
                    <p class="mrp">MRP: <span class="cut">₹${p.MRP}</span></p>
                    <p class="selling">Offer: <strong>₹${p.SellingPrice1pc}</strong></p>
                </div>
            `;
            container.innerHTML += card;
        });
    } catch (err) {
        console.error("Error loading products:", err);
    }
}

loadProducts();
</script>
