<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BeautyBucket — Quality Cosmetics. Quick Delivery.</title>
<link rel="stylesheet" href="styles.css" />
<style>
/* Small extra style tweaks for premium UI (keeps existing styles.css compatible) */
.header-sub { font-size:13px; opacity:.95; }
.p-body { padding: 8px 6px; display:flex; flex-direction:column; gap:8px; }
.p-title { font-size:16px; margin:0; color:#222; }
.products .product-card { transition: transform .12s ease, box-shadow .12s.ease; }
.products .product-card:hover { transform: translateY(-4px); box-shadow: 0 6px 20px rgba(0,0,0,.08); }
.badge { display:inline-block; min-width:60px; text-align:center; }
.empty { padding:28px; text-align:center; color:#666; }
@media (max-width:700px) {
  .img-wrap { height:140px; }
}
</style>
</head>
<body>
<header class="site-header">
  <div class="brand">
    <h1>BeautyBucket</h1>
    <div class="header-sub">Quality Cosmetics. Quick Delivery.</div>
  </div>
</header>

<main class="main">
  <aside class="sidebar" aria-label="Categories">
    <h3>Categories</h3>
    <ul id="categoryList" class="category-list"></ul>
    <h4 style="margin-top:14px">Filter by pincode</h4>
    <input id="pincodeInput" placeholder="Enter pincode" />
    <div id="pincodeMessage" class="muted" style="margin-top:8px"></div>
  </aside>

  <section class="content" aria-live="polite">
    <div class="controls">
      <input id="searchInput" placeholder="Search products..." />
    </div>
    <div id="productList" class="products grid"></div>
  </section>
</main>

<footer class="site-footer">
  <small>© BeautyBucket</small>
</footer>

<script>
/* ---------------- CONFIG ---------------- */
const PRODUCTS_CSV_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vQA2pIOTPv2AVnMSWtlKLJeSXQXxTllgHn2gGYcdd_ZbHARLmclz_OXy009Aw9hJqgpc-RXIk_HXkK4/pub?gid=125100016&single=true&output=csv";

const LOCAL_PINCODES = ["411001","411002","411003"];
const CITY_PREFIX = "411";

/* ===== CSV parser ===== */
function parseCSV(text) {
  text = text.replace(/^\uFEFF/, '').trim();
  if (!text) return [];
  const rows = [];
  let current = [''], col = 0, inQuotes = false;
  for (let i = 0; i < text.length; i++) {
    const ch = text[i], next = text[i+1];
    if (ch === '"') {
      if (inQuotes && next === '"') { current[col] += '"'; i++; continue; }
      inQuotes = !inQuotes; continue;
    }
    if (!inQuotes && ch === ',') { col++; current[col] = ''; continue; }
    if (!inQuotes && (ch === '\n' || ch === '\r')) {
      rows.push(current);
      current = ['']; col = 0;
      if (ch === '\r' && next === '\n') i++;
      continue;
    }
    current[col] += ch;
  }
  if (current && (current.length > 1 || current[0].trim() !== '')) rows.push(current);

  const headers = rows.shift().map(h => h.trim());
  return rows.map(r => {
    const obj = {};
    for (let i=0;i<headers.length;i++) obj[headers[i]] = (r[i]||'').trim();
    return obj;
  });
}

function formatPrice(v){
  if(v===undefined||v==='') return '—';
  const n=parseFloat((''+v).replace(/[^0-9.\-]/g,'')); 
  return isNaN(n)?'—':'₹'+n.toFixed(2);
}

let allProducts = [];

/* ===== Category Renderer ===== */
function renderCategories(){
  const cats = Array.from(new Set(allProducts.map(p => (p.Category||'Uncategorized').trim() )));
  const ul = document.getElementById('categoryList');
  ul.innerHTML = '';
  const liAll = document.createElement('li');
  liAll.textContent = 'All Products';
  liAll.className = 'cat-item active';
  liAll.onclick = () => {
    document.querySelectorAll('.cat-item').forEach(e=>e.classList.remove('active'));
    liAll.classList.add('active');
    renderProducts(allProducts);
  };
  ul.appendChild(liAll);

  cats.forEach(c => {
    const li = document.createElement('li');
    li.textContent = c;
    li.className = 'cat-item';
    li.onclick = () => {
      document.querySelectorAll('.cat-item').forEach(e=>e.classList.remove('active'));
      li.classList.add('active');
      renderProducts(allProducts.filter(p =>
        (p.Category||'').toLowerCase().trim() === c.toLowerCase().trim()
      ));
    };
    ul.appendChild(li);
  });
}

/* ===== Product Rend*
